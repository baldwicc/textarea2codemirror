!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../../mode/sql/sql")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],a):a(CodeMirror)}(function(a){"use strict";function b(b){var c=b.doc.modeOption;return"sql"===c&&(c="text/x-sql"),a.resolveMode(c).keywords}function c(a,b){var c=a.length,d=b.substr(0,c);return a.toUpperCase()===d.toUpperCase()}function d(a,b,d,e){for(var f in d)d.hasOwnProperty(f)&&(Array.isArray(d)&&(f=d[f]),c(b,f)&&a.push(e(f)))}function e(a,b){var c=b.getCursor(),e=b.getTokenAt(c),f=e.string.substr(1),g=n(c.line,e.start),h=b.getTokenAt(g).string;k.hasOwnProperty(h)||(h=i(h,b));var j=k[h];j&&d(a,f,j,function(a){return"."+a})}function f(a,b){if(a)for(var c=/[,;]/g,d=a.split(" "),e=0;e<d.length;e++)b(d[e]?d[e].replace(c,""):"")}function g(a){return a.line+a.ch/Math.pow(10,6)}function h(a){return n(Math.floor(a),+a.toString().split(".").pop())}function i(a,b){for(var c=b.doc,d=c.getValue(),e=a.toUpperCase(),i="",j="",l=[],o={start:n(0,0),end:n(b.lastLine(),b.getLineHandle(b.lastLine()).length)},p=d.indexOf(m.QUERY_DIV);-1!=p;)l.push(c.posFromIndex(p)),p=d.indexOf(m.QUERY_DIV,p+1);l.unshift(n(0,0)),l.push(n(b.lastLine(),b.getLineHandle(b.lastLine()).text.length));for(var q=0,r=g(b.getCursor()),s=0;s<l.length;s++){var t=g(l[s]);if(r>q&&t>=r){o={start:h(q),end:h(t)};break}q=t}for(var u=c.getRange(o.start,o.end,!1),s=0;s<u.length;s++){var v=u[s];if(f(v,function(a){var b=a.toUpperCase();b===e&&k.hasOwnProperty(i)&&(j=i),b!==m.ALIAS_KEYWORD&&(i=a)}),j)break}return j}function j(a,c){k=c&&c.tables||{},l=l||b(a);var f=a.getCursor(),g=a.getTokenAt(f),h=g.end,i=[],j=g.string.trim();if("."==j.charAt(0)){if(e(i,a),!i.length){for(;g.start&&"."==j.charAt(0);)g=a.getTokenAt(n(f.line,g.start-1)),j=g.string+j;d(i,j,k,function(a){return a})}}else d(i,j,l,function(a){return a.toUpperCase()}),d(i,j,k,function(a){return a});return{list:i,from:n(f.line,g.start),to:n(f.line,h)}}var k,l,m={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},n=a.Pos;a.registerHelper("hint","sql",j)});